---
title: "AMED3002 Reproducible Report"
author: "SID: "
date: "2025-05-07"
output: 
  rmdformats::downcute:
    number_sections: false
    toc_depth: 3
    use_bookdown: true
    code_folding: hide
---

```{r setup, include=FALSE}
library(knitr)
knitr::opts_chunk$set(echo = TRUE)

```


## Abstract {#abstract}



## Introduction {#introduction}

- [ ] Purpose and information accurate, concise and discerning and organised in a clear, logical 
and flowing manner. 

Modern cancer diagnostics increasingly rely on molecular profiling (Akbani et al., 2014, Golub et al., 1999, Han et al., 2014, Hoadley et al., 2014, Kandoth et al., 2013, Ramaswamy et al., 2001, Su et al., 2001), yet tissue biopsies remain invasive, complex, and often impractical in clinical settings, especially considering the varying conditions of cancer patients in practice. 

Many of the sampling methods that can be used for cancer diagnosis are limited by a variety of factors, including the tumor micro-environment, the stage of cancer regarding it's dissemination and metastasis in the body, the position of the cancer relative to vital organs, and other factors that can impede progress in diagnosis. One suggested method to overcome these limitations (Alix-Panabières et al., 2012, Crowley et al., 2013, Haber and Velculescu, 2014) and continue testing for diagnosis is to use a **blood based liquid biopsy**, which uses blood as a medium for specimen testing.

Many of the components of blood that come into contact with the tumor can be affected by the presence of cancer, which can lead to certain changes in the biology of those components and the resultant changes in biomarkers, that can be used to identify characteristics regarding the cancer. The added benefit of using this method over other diagnostic methods comes is the lack of invasion into the tumor or it's micro-environment, as this blood based liquid biopsies require blood samples that can be taken at a distance from the tumor site while still revealing information regarding the cancer. 

This blood based liquid biopsy not only includes the analysis of blood components, plasma, DNA, disseminated tumor cells, but also includes **tumor educated platelets (TEPs)** that come about as a result of the interaction between blood platelets, which are the second most abundant cell type in peripheral blood, and the tumor cells as they transfer tumor associated biomolecules between eachother. This process causes changes in the blood platelets, at which point they can be referred to as TEPs. The interaction induces  the sequestration of the tumor associated biomolecules (Klement et al., 2009, Kuznetsov et al., 2012, McAllister and Weinberg, 2014, Nilsson et al., 2011, Quail and Joyce, 2013), as well as an increased tolerance to external stimuli that can induce specific splicing of pre-MRNAs in circulating platelets. TEPs are also vulnerable to the induction of mRNA splicing events caused by signals produced by the tumor itself (Power et al., 2009, Rowley et al., 2011, Schubert et al., 2014), which gives these TEPs a very characteristic and dynamic **mRNA profile.** (Calverley et al., 2010, McAllister and Weinberg, 2014, Nilsson et al., 2011)

In a seminal 2015 study published in *Cancer Cell*, Best et al. reported that RNA sequencing of TEPs could accurately distinguish between healthy individuals and patients with various cancer types—including breast, lung, colorectal, and glioblastoma—using a **support vector machine (SVM)** trained on differentially expressed genes. The multiclass classifier reportedly achieved high accuracy across cohorts, suggesting TEPs could serve as a powerful tool for **non-invasive diagnostics**, that can help to more precisely identify a cancer subtype and allow for targeted treatment according to known characteristics of the subtype. (Calverley et al., 2010, Nilsson et al., 2011)

This study attempted to reproduce the findings of Best et al. (2011), who proposed a method using RNA-seq data from tumor-educated platelets (TEPs) for multiclass cancer diagnostics. With blood samples from both healthy donors and cancer patients consisting of "one drop of blood", the report was able to isolate platelets, perform mRNA amplification and mRNA-Seq analysis to obtain data about TEPs to be used in their research.

Their report aimed to determine if the characteristics that differentiate blood platelets to TEPs can be useful in cancer diagnostics for both localised and metastasized cancer patients, and also aimed to produce and test classification models for different cancer types using their observed data. The report claimed high diagnostic accuracy using SVM-based classification of platelet RNA profiles across six tumor types.

The objective of this study was to assess the reproducibility of their method using the supplemental datasets and experimental procedures provided, and determine if similar diagnostic performance could be achieved.

### Aim {#aim}

- [ ] Provides a summary of:
    - [ ] the aim,

The aim was to verify whether RNA signatures from TEPs could accurately distinguish between different cancer types and healthy individuals, using the same SVM and differential expression approaches described in the paper. 

Specifically, this study aimed to:

- Replicate the feature selection and classification pipeline using the provided gene expression datasets.
- Assess the model’s accuracy, sensitivity, and specificity on validation cohorts.
- Identify any methodological gaps or reproducibility issues encountered during replication.

### Methods {#methods}

- [ ] Provides a summary of:
    - [ ] methods and 
    
#### Sample Collection and Patient Information
Peripheral blood samples were collected from healthy donors (n = 55) and cancer patients (n = 228) across multiple cancer types, including glioblastoma, non-small cell lung cancer (NSCLC), colorectal cancer, pancreatic adenocarcinoma, breast carcinoma, and hepatobiliary carcinoma. For each patient, associated cancer-specific mutations and prior or ongoing treatments—including surgery, chemotherapy, and radiotherapy—were recorded.

Whole blood was drawn into purple-cap BD Vacutainer tubes containing EDTA as an anticoagulant. Platelets and plasma were isolated using a two-step centrifugation protocol (Best et al., 2015). Initially, whole blood was centrifuged at room temperature for 20 minutes at 120 × g to obtain platelet-rich plasma (PRP). Subsequently, PRP was centrifuged at 360 × g for 20 minutes to isolate the platelet pellet. Plasma was further centrifuged at 5000 rpm for 10 minutes to remove residual cellular debris and stored at −80°C for later nucleic acid extraction.

#### RNA Isolation and Library Preparation
Total RNA was extracted from the isolated platelets. Complementary DNA (cDNA) synthesis and amplification were performed using the SMARTer Ultra Low RNA Kit for Illumina Sequencing v1 (Clontech). Amplification targeted known mutation hotspots using high-fidelity polymerases to produce circular DNA amplicons suitable for next-generation sequencing. Quality and quantity of cDNA were assessed using the Agilent Bioanalyzer 2100 system with the DNA High Sensitivity chip. Sequencing libraries were prepared according to the manufacturer’s protocol and sequenced on an Illumina platform. Resulting reads were aligned to the human reference genome to generate expression matrices for downstream analysis.

#### Data Access and Preprocessing
This study adhered closely to the procedures described in the supplementary materials of Best et al. (2015). Processed gene expression data and classifier gene sets were obtained from supplemental files (`mmc2.xlsx` to `mmc8.xlsx`). Genes encoded on the Y chromosome and mitochondrial DNA were excluded from the analysis to minimize sex-based bias.

Due to the unavailability of raw sequencing files (e.g., FASTQ), the preprocessing pipeline could not be fully reconstructed. Consequently, certain parameters such as thresholding criteria for expression filtering were inferred based on log-transformed counts per million (logCPM) distributions and reported summary statistics.

#### Classification and Validation
Support vector machine (SVM) models were implemented in Python using the scikit-learn library. A leave-one-out cross-validation (LOOCV) approach was used for both binary and multiclass classification tasks, replicating the methodology described in the original publication. Linear kernel SVMs were trained using feature gene sets specified in the supplementary tables. Where hyperparameter values (e.g., C, gamma) were not disclosed, parameter tuning was performed empirically to optimize classification performance.

Validation was conducted using the original partitioning schema from Best et al. (2015), with 175 samples allocated to training and 108 to the validation cohort. Classifier performance was evaluated in terms of accuracy, sensitivity, and specificity.

#### Statistical Analysis
Differential gene expression was assessed using a filtering strategy analogous to that employed in edgeR, based on logCPM thresholds to retain sufficiently expressed genes. Due to limited methodological transparency in the original publication, some statistical thresholds and preprocessing decisions were approximated based on available data and description.


## Experimental Design and Workflow

- [ ] Is decisive on the appropriateness of the methods and analysis used in the paper and 
providing insight into plausible improvements of the experimental design and workflow.

The methodology employed by Best et al. (2015) is largely appropriate for investigating tumor-educated platelets (TEPs) as a non-invasive biomarker source for cancer diagnostics. Their design demonstrates ethical and practical considerations by prioritizing minimal patient burden through the use of blood-based liquid biopsies rather than tissue sampling. This aligns well with the clinical utility they propose—routine, low-risk diagnostics that can be applied even in vulnerable patient populations. Furthermore, the use of RNA-seq and a support vector machine (SVM) classifier for multiclass cancer prediction is methodologically sound and reflects a thoughtful integration of transcriptomic data with machine learning for diagnostic applications.

However, the experimental design could be improved by addressing the potential bias introduced by excluding samples with low RNA yield or reduced predictive value. While this exclusion criterion strengthens statistical power and model robustness, it also introduces the risk of discarding biologically informative outliers, including rare transcripts or low-abundance biomarkers that could prove relevant, particularly in early-stage or heterogeneous cancers. Incorporating a secondary analysis pipeline that includes these marginal samples could help uncover additional diagnostic signals.

Moreover, the decision to omit genes located on the Y chromosome and mitochondrial genome is justifiable given the goal of minimizing gender-associated confounding variables. Nonetheless, such exclusion limits the scope of discovery. These genomic regions may harbor cancer-relevant signals that, while gender-specific, could enhance stratified diagnostics if analyzed in sex-separated cohorts. A future iteration of the study would benefit from a parallel analysis including these regions under stratified conditions.

Overall, the experimental workflow is replicable and conceptually robust, but opportunities exist to broaden its inclusivity and interpretive depth without compromising clinical relevance.

## Results {#results}

- [ ] Inspires dissemination of information and findings.

- [ ] Attracts and continually promotes emotional and intellectual engagement.

- [ ] Graphics are clear and reasonable replicas or improvements of the originals.

- [ ] Insightful and intuitive report of analytical methods for target readership.


```{r, warning=FALSE, message=FALSE}
# find human intron-spanning genes
library(EnsDb.Hsapiens.v86)
edb <- EnsDb.Hsapiens.v86
exons_by_gene_ensembl <- exonsBy(edb, by = "gene")
# Count exons per gene
exon_counts_ensembl <- elementNROWS(exons_by_gene_ensembl)
# Genes with > 1 exon
intron_spanning_genes_ensembl <- names(exon_counts_ensembl)[exon_counts_ensembl > 1]



# Read in data as tibble and convert to df
library(edgeR)
library(readr)
library(org.Hs.eg.db)
library(ggplot2)


df_all_counts = as.data.frame(readr::read_tsv("GSE68086_TEP_data_matrix.txt"))
# set row names as gene IDs
rownames(df_all_counts) <- df_all_counts[[1]]
df_all_counts <- df_all_counts[,-1]
# coerce counts to numeric
df_all_counts[] <- lapply(df_all_counts, as.numeric)

# filter out cols (samples) with IS read counts < 0.4 x 10^6
sample_totals <- colSums(df_all_counts)  
df_all_counts <- df_all_counts[, sample_totals > 4e5]

# subset by intron-spanning
## 57,736 --> 33,937 rows
df_all_counts <- df_all_counts[rownames(df_all_counts) %in% intron_spanning_genes_ensembl, ]


# filter out genes with <5 counts in all samples (none)
## goes from 285 --> 282, should be 288 ---> 283
keep <- rowSums(df_all_counts >= 5) > 0
counts_filtered <- df_all_counts[keep, ]

# set up groups as cancerous and noncancereous 
group <- factor(ifelse(grepl("^HD", colnames(counts_filtered)), "Healthy", "Cancerous"))

# create DGE list and calculate normalisation factors with TMM method
dge <- DGEList(counts = counts_filtered, group = group)
# remove y chr genes
chr <- mapIds(org.Hs.eg.db, keys = rownames(dge), column = "CHR", keytype = "ENSEMBL", multiVals = "first")
dge <- dge[chr != "Y" & !is.na(chr), , keep.lib.sizes = FALSE]
dge <- calcNormFactors(dge, method = "TMM")

# find logCPM and filter by genes with at least one reading of logCPM > 3 
logCPM <- cpm(dge, log = TRUE)
keep <- rowSums(logCPM > 3) > 0
dge <- dge[keep, , keep.lib.sizes = FALSE]

# make the design matrix, specifying which samples are in the healthy group
design <- model.matrix(~ group)
dge <- estimateDisp(dge, design)

# find log fold changes
fit <- glmFit(dge, design)
lrt <- glmLRT(fit, coef = 2)  
res <- topTags(lrt, n = Inf)$table

# rownames are ENSEMBL IDs, make col 'symbol' of SYMBOL IDs
res$symbol <- mapIds(org.Hs.eg.db, keys=rownames(res), column=c("SYMBOL"), keytype="ENSEMBL", multiVals = "first")



## find logCPM between healthy and cancerous for each gene
logCPM <- cpm(dge, log = TRUE)  # logCPM for each gene in each sample
logCPM_healthy <- rowMeans(logCPM[, group == "Healthy"])
logCPM_cancerous <- rowMeans(logCPM[, group == "Cancerous"])
avg_logCPM <- data.frame(
  ENSEMBL = rownames(logCPM),
  logCPM_healthy = logCPM_healthy,
  logCPM_cancerous = logCPM_cancerous
)
res$ENSEMBL <- rownames(res)
res_plot <- merge(res, avg_logCPM, by = "ENSEMBL")

# split into increased decreased and no significant change in expression
df <- res
df$Expression <- "Unchanged"
df$Expression[df$logFC > 0 & df$FDR < 0.01] <- "Decreased"
df$Expression[df$logFC < 0  & df$FDR < 0.01] <- "Increased"   
df$Expression <- factor(df$Expression, levels = c("Increased", "Decreased", "Unchanged"))

# merge df with logcpm healthy and cancerous  
df$ENSEMBL <- rownames(df)
df <- merge(df, avg_logCPM, by = "ENSEMBL")

# Calculate correlation test between logCPM_healthy and logCPM_cancerous
cor_test <- cor.test(df$logCPM_healthy, df$logCPM_cancerous)

# Extract correlation coefficient and p-value
r_value <- cor_test$estimate
p_value <- cor_test$p.value

# plot
ggplot(df, aes(x = logCPM_healthy, y = logCPM_cancerous, color = Expression)) +
  geom_point(size = 1, alpha = 0.7) +
  scale_color_manual(values = c("Increased" = "red", "Decreased" = "blue", "Unchanged" = "grey")) +
  labs(
    title = paste0("Total TEP mRNAs (n = ", nrow(df), ")"),
    x = expression("Mean Log"[2]*" CPM Healthy"),
    y = expression("Mean Log"[2]*" CPM Cancer"),
    color = ""
  ) +
  annotate("text", x = 2.5, y = 15.5, label = paste0("Increased (n = ", sum(df$Expression == "Increased"), ")"), color = "red") +
  annotate("text", x = 2.5, y = 14.5, label = paste0("Decreased (n = ", sum(df$Expression == "Decreased"), ")"), color = "blue") +
  annotate("text", x = 11, y = 1.5, label = paste0("r = ", round(r_value, 2))) +
  annotate("text", x = 11, y = 0.5, label = paste0("p = ", format.pval(p_value, digits = 2, eps = 1e-16))) + 
  theme_bw(base_size = 12) +
  theme(
    panel.grid = element_blank(),
    axis.title = element_text(size = 12, face = "bold"),
    plot.title = element_text(hjust = 1, face = "bold"),
    legend.position = "none"
  )
```


```{r, warning=FALSE, message=FALSE}
library(limma)
library(dplyr)
library(readxl)

df <- read_excel("mmc3.xlsx")

data_path <- "GSE68086_TEP_data_matrix.txt"
expr <- read.table(data_path, header = TRUE, sep = "\t", row.names = 1, check.names = FALSE)

common_genes <- df$`Ensembl gene ID`
expr_filtered <- expr[rownames(expr) %in% common_genes, ]

expVal <- as.matrix(expr_filtered)

samples <- colnames(expVal)

healthy_samples <- grepl("^HD-|^Control-", samples)

pheno <- data.frame(
  Sample = samples,
  survClass = ifelse(healthy_samples, "Healthy", "Cancer")
)

columnColour <- pheno$survClass
columnColour[columnColour == "Cancer"] <- "red"
columnColour[columnColour == "Healthy"] <- "grey"

useColumns <- !is.na(columnColour)

var <- names(sort(-apply(expVal, 1, var)))

gene_vars <- apply(expVal, 1, var)
top_genes <- names(sort(gene_vars, decreasing = TRUE))[1:100]
```

```{r, warning=FALSE, message=FALSE}
coolmap(expVal[var, useColumns],
        ColSideColors = columnColour[useColumns],
        labRow = NA,
        labCol = NA)
par(xpd = TRUE)
legend("topright",
       legend = c("Cancer", "Healthy"),
       fill = c("red", "grey"),
       border = NA,
       bty = "n",
       title = "Group",
       inset = c(-0.065, 0),
       cex = 0.7)
```

```{r}
gene_universe <- rownames(expVal)
gene_list_of_interest <- df$`Ensembl gene ID`[df$`Ensembl gene ID` %in% gene_universe]
selected_top_genes <- top_genes[top_genes %in% gene_universe]

overlap <- length(intersect(selected_top_genes, gene_list_of_interest))
only_in_list <- length(setdiff(gene_list_of_interest, selected_top_genes))
only_in_top <- length(setdiff(selected_top_genes, gene_list_of_interest))
neither <- length(setdiff(gene_universe, union(selected_top_genes, gene_list_of_interest)))

contingency_table <- matrix(c(overlap, only_in_list, only_in_top, neither), nrow = 2)
colnames(contingency_table) <- c("In List", "Not in List")
rownames(contingency_table) <- c("Top Genes", "Not Top Genes")

fisher_result <- fisher.test(contingency_table)

print(contingency_table)
print(fisher_result)
```



```{r, warning=FALSE, message=FALSE}
library(limma)
library(dplyr)
library(readxl)

data_path <- "GSE68086_TEP_data_matrix.txt"
expr <- read.table(data_path, header = TRUE, sep = "\t", row.names = 1, check.names = FALSE)
```

```{r, warning=FALSE, message=FALSE}
file_path <- "mmc6.xlsx"
sheet_names <- excel_sheets(file_path)
sheet_dfs <- list()

for (sheet in sheet_names) {
  sheet_df <- read_excel(file_path, sheet = sheet)
  sheet_dfs[[sheet]] <- sheet_df
}


filtered_expr_list <- list()

for (sheet in names(sheet_dfs)) {
  df <- sheet_dfs[[sheet]]

  common_genes <- df$`Ensembl gene ID`
  expr_filtered <- expr[rownames(expr) %in% common_genes, , drop = FALSE]

  filtered_expr_list[[sheet]] <- expr_filtered
}
```


```{r, warning=FALSE, message=FALSE}
for (sheet in names(filtered_expr_list)) {
  expr_filtered <- filtered_expr_list[[sheet]]
  
  expVal <- as.matrix(expr_filtered)

  samples <- colnames(expVal)
  healthy_samples <- grepl("^HD-|^Control-", samples)
  
  pheno <- data.frame(
    Sample = samples,
    survClass = ifelse(healthy_samples, "Healthy", "Cancer")
  )
  
  columnColour <- pheno$survClass
  columnColour[columnColour == "Cancer"] <- "red"
  columnColour[columnColour == "Healthy"] <- "grey"
  
  useColumns <- !is.na(columnColour)
  
  gene_var <- apply(expVal, 1, var)
  
  group <- factor(pheno$survClass)
  design <- model.matrix(~ 0 + group)
  colnames(design) <- levels(group)
  
  fit <- lmFit(expVal, design)
  contrast.matrix <- makeContrasts(Cancer - Healthy, levels = design)
  fit2 <- contrasts.fit(fit, contrast.matrix)
  fit2 <- eBayes(fit2)
  results <- topTable(fit2, number = Inf, adjust.method = "fdr")
  
  # Select DEGs: FDR < 0.05
  deg_genes <- rownames(results)[results$adj.P.Val < 0.05]
  deg_genes <- deg_genes[deg_genes %in% gene_universe]  # Ensure overlap with current matrix
  
  # Use DEGs as 'foreground'
  foreground_genes <- deg_genes
  
  coolmap(expVal[deg_genes, useColumns],
          ColSideColors = columnColour[useColumns],
          labRow = NA,
          labCol = NA,
          main = paste("Heatmap -", sheet))
  
  par(xpd = TRUE)
  legend("topright",
         legend = c("Cancer", "Healthy"),
         fill = c("red", "grey"),
         border = NA,
         bty = "n",
         title = "Group",
         inset = c(-0.065, 0),
         cex = 0.7)
  
  gene_universe <- rownames(expVal)
  gene_list_of_interest <- df$`Ensembl gene ID`[df$`Ensembl gene ID` %in% gene_universe]
  
  # Construct contingency table
  overlap <- length(intersect(foreground_genes, gene_list_of_interest))
  only_in_list <- length(setdiff(gene_list_of_interest, foreground_genes))
  only_in_foreground <- length(setdiff(foreground_genes, gene_list_of_interest))
  neither <- length(setdiff(gene_universe, union(foreground_genes, gene_list_of_interest)))
  
  contingency_table <- matrix(c(overlap, only_in_list, only_in_foreground, neither), nrow = 2)
  colnames(contingency_table) <- c("In List", "Not in List")
  rownames(contingency_table) <- c("DEG", "Not DEG")
  
  fisher_result <- fisher.test(contingency_table)
  
  print(contingency_table)
  print(fisher_result)
}
```

```{r}
library(e1071)
library(caret)
library(dplyr)

mmc3 <- read_excel("mmc3.xlsx")

data_path <- "GSE68086_TEP_data_matrix.txt"
sample_data <- read.table(data_path, header = TRUE, sep = "\t", row.names = 1, check.names = FALSE)

gene_list <- as.character(mmc3$`Ensembl gene ID`)
sample_data_filtered <- sample_data[rownames(sample_data) %in% gene_list, ]

column_labels <- ifelse(grepl("^HD-|^Control-", colnames(sample_data)), "Healthy", "Cancer")

sample_data_r_labelled <- rbind(sample_data_filtered, label = column_labels)
```

```{r}
sample_data_t <- as.data.frame(t(sample_data_r_labelled))

labels <- as.factor(sample_data_t$label)

features <- sample_data_t[ , !(colnames(sample_data_t) %in% "label")]

features <- as.data.frame(lapply(features, as.numeric))

set.seed(123)
train_idx <- createDataPartition(labels, p = 0.7, list = FALSE)

X_train <- features[train_idx, ]
y_train <- labels[train_idx]
X_test <- features[-train_idx, ]
y_test <- labels[-train_idx]

svm_model <- svm(x = X_train, y = y_train, kernel = "linear", probability = TRUE)

y_pred <- predict(svm_model, X_test)

conf <- confusionMatrix(y_pred, y_test)
print(conf)
```




```{r}
library(e1071)
library(caret)
library(dplyr)
library(readxl)

data_path <- "sample_data.txt"
sample_data <- read.table(data_path, header = TRUE, sep = "\t", row.names = 1, check.names = FALSE)

file_path <- "mmc6.xlsx"
sheet_names <- excel_sheets(file_path)
sheet_dfs <- list()

for (sheet in sheet_names) {
  sheet_df <- read_excel(file_path, sheet = sheet)
  sheet_dfs[[sheet]] <- sheet_df
}
```

```{r}
column_labels <- case_when(
  grepl("^CRC-|^Liver-|^Chol-", colnames(sample_data))     ~ "CRC",
  grepl("Pancr", colnames(sample_data))    ~ "PAAD",
  grepl("Breast", colnames(sample_data))  ~ "HBC",
  TRUE                                    ~ NA
)

sample_data_3 <- rbind(sample_data, label = column_labels)
sample_data_3 <- sample_data_3[, colSums(is.na(sample_data_3)) == 0]

sample_data_3_t <- as.data.frame(t(sample_data_3))

nzv <- nearZeroVar(sample_data_3_t, saveMetrics = TRUE)
sample_data_3_t <- sample_data_3_t[, !nzv$nzv] 

features <- sample_data_3_t[, !(colnames(sample_data_3_t) %in% "label")]
labels <- as.factor(sample_data_3_t$label)

features <- as.data.frame(lapply(features, as.numeric))

set.seed(123)
train_idx <- createDataPartition(labels, p = 0.7, list = FALSE)

X_train <- features[train_idx, ]
y_train <- labels[train_idx]
X_test <- features[-train_idx, ]
y_test <- labels[-train_idx]

svm_model <- svm(x = X_train, y = y_train, kernel = "linear", probability = TRUE)

y_pred <- predict(svm_model, X_test)

conf <- confusionMatrix(y_pred, y_test)
print(conf)
```

```{r}
column_labels <- case_when(
  grepl("HD", colnames(sample_data)) ~ "Healthy",
  grepl("GBM", colnames(sample_data))     ~ "GBM",
  grepl("^NSCLC-|^Lung-", colnames(sample_data))   ~ "NSCLC",
  grepl("^CRC-|^Liver-|^Chol-", colnames(sample_data))     ~ "CRC",
  grepl("Pancr", colnames(sample_data))    ~ "PAAD",
  grepl("Breast", colnames(sample_data))  ~ "HBC",
  grepl("BrCa", colnames(sample_data))    ~ "BrCa",
  TRUE                                    ~ NA
)

sample_data_3 <- rbind(sample_data, label = column_labels)
sample_data_3 <- sample_data_3[, colSums(is.na(sample_data_3)) == 0]

sample_data_3_t <- as.data.frame(t(sample_data_3))

nzv <- nearZeroVar(sample_data_3_t, saveMetrics = TRUE)
sample_data_3_t <- sample_data_3_t[, !nzv$nzv] 

features <- sample_data_3_t[, !(colnames(sample_data_3_t) %in% "label")]
labels <- as.factor(sample_data_3_t$label)

features <- as.data.frame(lapply(features, as.numeric))

set.seed(123)
train_idx <- createDataPartition(labels, p = 0.7, list = FALSE)

X_train <- features[train_idx, ]
y_train <- labels[train_idx]
X_test <- features[-train_idx, ]
y_test <- labels[-train_idx]

svm_model <- svm(x = X_train, y = y_train, kernel = "linear", probability = TRUE)

y_pred <- predict(svm_model, X_test)

conf <- confusionMatrix(y_pred, y_test)
print(conf)
```


Graphs Present:

- Table summary of Patient Characteristics

    - https://pmc.ncbi.nlm.nih.gov/articles/PMC4644263/table/tbl1/

    - `mmc2.xlsx`

- Table Pan-Cancer CAGE Gene Ontology

    - https://pmc.ncbi.nlm.nih.gov/articles/PMC4644263/table/tbl2/

    - ??? source ???

- 6 Graphs

    - https://pmc.ncbi.nlm.nih.gov/articles/PMC4644263/figure/fig2/

    - Heatmaps of unsupervised clustering of platelet mRNA profiles of healthy donors (HD; n = 55) (red) and patients with non-small cell lung cancer (NSCLC; n = 60), colorectal cancer (CRC; n = 41), glioblastoma (GBM; n = 39), pancreatic cancer (PAAD, n = 35), breast cancer (BrCa; n = 39; female HD; n = 29), and hepatobiliary cancer (HBC; n = 14).

    - ROC-curve of SVM diagnostics of healthy donors and individual tumor classes in both training (left) and validation (right) cohort. Random classifiers, indicating the classification accuracies obtained by chance, are shown in gray.

    - Confusion matrix of multiclass SVM/LOOCV diagnostics of patients with CRC, PAAD, and HBC. Indicated are detection rates as compared to the actual classes in percentages.

    - Confusion matrix of multiclass SVM/LOOCV diagnostics of the training cohort consisting of healthy donors (healthy) and patients with GBM, NSCLC, PAAD, CRC, BrCa, and HBC. Indicated are detection rates as compared to the actual classes in percentages.

    - Confusion matrix of multiclass SVM algorithm in a validation cohort (n = 108). Indicated are sample numbers and detection rates in percentages. Genes, number of mRNAs included in training of the SVM algorithm.

    - `mmc5.xlsx`, `mmc6.xlsx`, `mmc7.xlsx`

- Cross tables of SVM/LOOCV diagnostics

    - https://pmc.ncbi.nlm.nih.gov/articles/PMC4644263/figure/fig3/

    - CRC

    - PAAD

    - NSCLC patients

    - KRAS in the combined cohort of patients with either CRC, PAAD, NSCLC, or HBC

    - EGFR 

    - MET in NSCLC patients

    - PIK3CA mutations

    - HER2-amplification

    - triple negative status in BrCa patients

    - `mmc5.xlsx` and `mmc8.xlsx`

- Organ-Focused TEP-Based Cancer Diagnostics

    - https://pmc.ncbi.nlm.nih.gov/articles/PMC4644263/figure/fig4/

    - ??? source ???

## Discussion

- [ ] The success or difficulties in reproducing their results are used to critique the 
findings and conclusions of the manuscript.

- [ ] Is decisive on the appropriateness of the methods and analysis used in the paper and 
providing insight into plausible improvements of the experimental design and workflow.

- [ ] Comment on the appropriateness of the methods and analysis used in the paper.

- [ ] Outline the success or difficulties you had reproducing their results.

## Conclusion {#conclusion}

- [ ] Provides a summary of:
    - [ ] results of the paper.
    
## References

- [ ] Citation, spelling and grammar correct and keeps to word limit.

Akbani et al. (2014), [A pan-cancer proteomic perspective on The Cancer Genome Atlas. Nat. Commun.](https://pmc.ncbi.nlm.nih.gov/articles/PMC4109726/)

Golub et al. (1999), [Molecular classification of cancer: class discovery and class prediction by gene expression monitoring. Science.](https://pubmed.ncbi.nlm.nih.gov/10521349/)

Han et al. (2014), [The Pan-Cancer analysis of pseudogene expression reveals biologically and clinically relevant tumour subtypes. Nat. Commun.](https://pmc.ncbi.nlm.nih.gov/articles/PMC4339277/)

Hoadley et al. (2014),[Cancer Genome Atlas Research Network Multiplatform analysis of 12 cancer types reveals molecular classification within and across tissues of origin. Cell.](https://pmc.ncbi.nlm.nih.gov/articles/PMC4152462/)

Kandoth et al. (2013), [Mutational landscape and significance across 12 major cancer types. Nature.](https://pmc.ncbi.nlm.nih.gov/articles/PMC3927368/)

Ramaswamy et al. (2001), [Multiclass cancer diagnosis using tumor gene expression signatures. Proc. Natl. Acad. Sci.](https://pmc.ncbi.nlm.nih.gov/articles/PMC64998/)

Su et al. (2001), [Molecular classification of human carcinomas by use of gene expression signatures. Cancer Res.](https://pubmed.ncbi.nlm.nih.gov/11606367/)

Alix-Panabières et al. (2012), [Challenges in circulating tumour cell research. Nat. Rev. Cancer.](https://pubmed.ncbi.nlm.nih.gov/25154812/)

Crowley et al. (2013), [Liquid biopsy: monitoring cancer-genetics in the blood. Nat. Rev. Clin. Oncol.](https://pubmed.ncbi.nlm.nih.gov/23836314/)

Haber and Velculescu (2014), [Blood-based analyses of cancer: circulating tumor cells and circulating tumor DNA. Cancer Discov. ](https://pmc.ncbi.nlm.nih.gov/articles/PMC4433544/)

Klement et al. (2009), [Platelets actively sequester angiogenesis regulators. Blood.](https://pmc.ncbi.nlm.nih.gov/articles/PMC2661866/)

Kuznetsov et al. (2012), [Identification of luminal breast cancers that establish a tumor-supportive macroenvironment defined by proangiogenic platelets and bone marrow-derived cells. Cancer Discov.](https://pmc.ncbi.nlm.nih.gov/articles/PMC3517696/)

McAllister and Weinberg (2014), [The tumour-induced systemic environment as a critical regulator of cancer progression and metastasis. Nat. Cell Biol.](https://pmc.ncbi.nlm.nih.gov/articles/PMC6220424/)

Quail and Joyce (2013), [Microenvironmental regulation of tumor progression and metastasis. Nat. Med.](https://pmc.ncbi.nlm.nih.gov/articles/PMC3954707/)

Power et al. (2009), [High-throughput proteomics detection of novel splice isoforms in human platelets. PLoS ONE. ](https://pmc.ncbi.nlm.nih.gov/articles/PMC2654914/)

Rowley et al. (2011), [Genome-wide RNA-seq analysis of human and mouse platelet transcriptomes. Blood.](https://pmc.ncbi.nlm.nih.gov/articles/PMC3193274/)

Schubert et al. 2014, [A tour through the transcriptional landscape of platelets. Blood.](https://pmc.ncbi.nlm.nih.gov/articles/PMC4110657/)

Calverley et al. (2010), [Significant downregulation of platelet gene expression in metastatic lung cancer. Clin. Transl. Sci.](https://pmc.ncbi.nlm.nih.gov/articles/PMC3427741/)

Best et al. (2011) [Blood platelets contain tumor-derived RNA biomarkers](https://pmc.ncbi.nlm.nih.gov/articles/PMC4644263/)
